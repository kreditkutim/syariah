<!DOCTYPE html>
<html>
<head>
  <title>Cek Data Cicilan</title>
</head>
<body>
  <h1>Cek Data Cicilan</h1>
  <form id="formCek">
    <input type="text" id="kode" placeholder="Masukkan 8 digit kode" required>
    <button type="submit">Cek</button>
  </form>
  <div id="hasil"></div>

  <script>
    document.getElementById("formCek").addEventListener("submit", async (e) => {
      e.preventDefault();
      const kode = document.getElementById("kode").value;
      const url = `URL_APPS_SCRIPT?kode=${kode}`;

      try {
        const response = await fetch(url);
        const data = await response.json();
        
        if (data.status === "error") {
          document.getElementById("hasil").innerHTML = `<p style="color:red">${data.message}</p>`;
        } else {
          const cicilanList = data.data.cicilan.map(c => 
            `<li>${c.tanggal}: Rp ${c.nominal.toLocaleString()}</li>`
          ).join("");
          
          document.getElementById("hasil").innerHTML = `
            <h3>Data Konsumen</h3>
            <p>Nama: ${data.data.nama}</p>
            <p>Barang: ${data.data.barang}</p>
            <p>Total Harga: Rp ${data.data.harga.toLocaleString()}</p>
            <h4>Riwayat Cicilan:</h4>
            <ul>${cicilanList}</ul>
          `;
        }
      } catch (error) {
        console.error("Error:", error);
      }
    });
  </script>
</body>
</html>
