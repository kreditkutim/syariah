<!DOCTYPE html>
<html>
<head>
  <title>Detail Konsumen</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h1>Detail Konsumen</h1>
  <div id="detailKonsumen"></div>
  <h2>Riwayat Pembayaran</h2>
  <table id="riwayatPembayaran">
    <thead>
      <tr>
        <th>Tanggal</th>
        <th>Nominal</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const kode = urlParams.get('kode');
    
    if (kode) {
      fetch(`https://script.google.com/macros/s/AKfycbz5VJRylw-dvset6w_JhzVkgUZ1zW5viLtJTKDS7hPSgHuRDBu3vYxqBEHu4cqebfxu/exec?kode=${kode}`; 
            .then(response => response.json())
        .then(data => {
          if (data.status === "success") {
            // Tampilkan detail konsumen
            document.getElementById('detailKonsumen').innerHTML = `
              <p><strong>Kode:</strong> ${data.data.kode}</p>
              <p><strong>Nama:</strong> ${data.data.nama}</p>
              <p><strong>Barang:</strong> ${data.data.barang}</p>
              <p><strong>Harga:</strong> ${data.data.harga}</p>
              <p><strong>Cicilan per Bulan:</strong> ${data.data.cicilanPerBulan}</p>
              <p><strong>Lama Cicilan:</strong> ${data.data.lamaBulan} bulan</p>
              <p><strong>Tanggal Mulai:</strong> ${data.data.tanggalMulai}</p>
              <p><strong>Status:</strong> ${data.data.status}</p>
              <p><strong>Total Dibayar:</strong> ${data.data.totalBayar}</p>
              <p><strong>Sisa Pembayaran:</strong> ${data.data.sisaPembayaran}</p>
            `;
            
            // Tampilkan riwayat pembayaran
            const tbody = document.querySelector('#riwayatPembayaran tbody');
            data.data.cicilan.forEach(item => {
              const row = document.createElement('tr');
              row.innerHTML = `
                <td>${item.tanggal}</td>
                <td>${item.nominal}</td>
              `;
              tbody.appendChild(row);
            });
          } else {
            alert(data.error || 'Terjadi kesalahan');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          alert('Gagal mengambil data');
        });
    } else {
      alert('Parameter kode tidak ditemukan');
    }
  </script>
</body>
</html>
